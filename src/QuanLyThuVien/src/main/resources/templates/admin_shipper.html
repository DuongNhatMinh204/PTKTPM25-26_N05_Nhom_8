<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Admin - Qu·∫£n L√Ω T√†i Kho·∫£n Shipper</title>
    <link rel="stylesheet" href="/css/admin_books.css"> <!-- D√πng l·∫°i CSS chung -->
    <style>
        /* B·ªï sung m·ªôt ch√∫t style ri√™ng */
        .main-content h1 {
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
        }

        th {
            background-color: #007bff;
            color: white;
            text-align: center;
            padding: 10px;
        }

        td {
            text-align: center;
            padding: 10px;
            border-top: 1px solid #eee;
        }

        .add-btn {
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .add-btn:hover {
            background-color: #218838;
        }

        /* Modal ·∫®n M·∫∑c ƒê·ªãnh */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }

        /* N·ªôi Dung Modal */
        .modal-content {
            background: #fff;
            margin: 5% auto;
            padding: 20px;
            border-radius: 8px;
            width: 60%;
            max-width: 600px;
            position: relative;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #555;
        }

        .close:hover {
            color: red;
        }

        .form-label {
            font-weight: 600;
        }

        .form-control, .form-select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .create-btn {
            background-color: #007bff;
            color: white;
            font-weight: 600;
            border: none;
            padding: 10px;
            width: 100%;
            border-radius: 5px;
            cursor: pointer;
        }

        .create-btn:hover {
            background-color: #0056b3;
        }

    </style>
</head>
<body>
<div class="admin-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <h2>Admin Panel</h2>
        <ul>
            <li onclick="window.location.href='/admin'">üìö Qu·∫£n L√Ω S√°ch</li>
            <li onclick="window.location.href='/admin_orders'">üì¶ Qu·∫£n L√Ω ƒê∆°n H√†ng</li>
            <li>üë§ Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</li>
            <li class="active" onclick="window.location.href='/admin_shipper'">üöö Qu·∫£n L√Ω T√†i Kho·∫£n Shipper</li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <h1>üöö Danh S√°ch Shipper</h1>
        <button class="add-btn" onclick="openModal()">+ T·∫°o T√†i Kho·∫£n M·ªõi</button>

        <table id="shipperTable">
            <thead>
            <tr>
                <th>STT</th>
                <th>T√™n Shipper</th>
                <th>S·ªë ƒêi·ªán Tho·∫°i</th>
            </tr>
            </thead>
            <tbody id="shipperTableBody">
            <!-- JS render -->
            </tbody>
        </table>
    </div>
</div>

<!-- Modal T·∫°o Shipper -->
<div id="createModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <h2>T·∫°o T√†i Kho·∫£n Shipper</h2>
        <form id="createShipperForm">
            <label class="form-label">H·ªç V√† T√™n</label>
            <input type="text" class="form-control" id="fullName" required>

            <label class="form-label">Email</label>
            <input type="email" class="form-control" id="email" required>

            <label class="form-label">S·ªë ƒêi·ªán Tho·∫°i</label>
            <input type="text" class="form-control" id="phone" required>

            <label class="form-label">M·∫≠t Kh·∫©u</label>
            <input type="password" class="form-control" id="password" required>

            <label class="form-label">X√°c Nh·∫≠n M·∫≠t Kh·∫©u</label>
            <input type="password" class="form-control" id="confirmPassword" required>

            <label class="form-label">Ng√†y Sinh (dd-MM-yyyy)</label>
            <input type="text" class="form-control" id="birthday" placeholder="vd: 27-12-2004" required>

            <label class="form-label">Gi·ªõi T√≠nh</label>
            <select id="gender" class="form-select" required>
                <option value="">-- Ch·ªçn gi·ªõi t√≠nh --</option>
                <option value="Nam">Nam</option>
                <option value="N·ªØ">N·ªØ</option>
            </select>

            <button type="submit" class="create-btn">T·∫°o M·ªõi</button>
        </form>
    </div>
</div>

<script>
    // ====== G·ªåI API L·∫§Y DANH S√ÅCH SHIPPER ======
    async function loadShippers() {
        const response = await fetch("http://localhost:8080/api/shipper/get-all");
        const result = await response.json();
        const tbody = document.getElementById("shipperTableBody");
        tbody.innerHTML = "";

        if (result.code === 1000 && result.data.length > 0) {
            result.data.forEach((shipper, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${shipper.shipperName}</td>
                        <td>${shipper.shipperPhone}</td>
                    </tr>`;
            });
        } else {
            tbody.innerHTML = `<tr><td colspan="3">Kh√¥ng c√≥ shipper n√†o</td></tr>`;
        }
    }

    // ====== M·ªû & ƒê√ìNG MODAL ======
    function openModal() {
        document.getElementById("createModal").style.display = "block";
    }
    function closeModal() {
        document.getElementById("createModal").style.display = "none";
        document.getElementById("createShipperForm").reset();
    }
    window.onclick = function (event) {
        const modal = document.getElementById("createModal");
        if (event.target === modal) modal.style.display = "none";
    };

    // ====== G·ª¨I FORM T·∫†O SHIPPER ======
    document.getElementById("createShipperForm").addEventListener("submit", async (e) => {
        e.preventDefault();
        const data = {
            fullName: document.getElementById("fullName").value,
            email: document.getElementById("email").value,
            phone: document.getElementById("phone").value,
            password: document.getElementById("password").value,
            confirmPassword: document.getElementById("confirmPassword").value,
            birthday: document.getElementById("birthday").value,
            gender: document.getElementById("gender").value
        };

        const response = await fetch("http://localhost:8080/api/shipper/create", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        if (result.code === 1000) {
            alert("‚úÖ T·∫°o t√†i kho·∫£n th√†nh c√¥ng!");
            closeModal();
            loadShippers();
        } else {
            alert("‚ùå T·∫°o th·∫•t b·∫°i! Vui l√≤ng ki·ªÉm tra l·∫°i th√¥ng tin.");
        }
    });

    // ====== LOAD DANH S√ÅCH L√öC M·ªû TRANG ======
    window.onload = loadShippers;
</script>
</body>
</html>
